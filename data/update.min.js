async function startOTA(){const e=document.getElementById("ota-file"),t=document.querySelector('input[name="update-type"]:checked'),o=document.getElementById("ota-btn"),s=document.getElementById("ota-progress-bar"),n=document.getElementById("ota-percent"),a=document.getElementById("ota-progress-container");if(0===e.files.length)return void showToast("Please select a file first.");const d=e.files[0],l=t.value;if(!confirm(`Are you sure you want to flash this ${l} update? The device will reboot.`))return;o.disabled=!0,o.classList.add("loading"),a.style.display="block";const i=new XMLHttpRequest;i.open("POST","/api/ota?type="+("spiffs"===l?"spiffs":"app"),!0),i.upload.onprogress=e=>{if(e.lengthComputable){const t=Math.round(e.loaded/e.total*100);s.style.width=t+"%",n.textContent=t+"%"}},i.onload=()=>{o.classList.remove("loading"),200===i.status?(showToast("Update successful! Rebooting...","success"),s.style.width="100%",n.textContent="100%",setTimeout(()=>{window.location.href="/"},5e3)):(showToast("Update failed: "+i.responseText),o.disabled=!1)},i.onerror=()=>{showToast("Connection error during update."),o.disabled=!1,o.classList.remove("loading")},i.send(d)}