const RELAY_NAMES=["Plants","Front Lawn","Grass","Patio Grass"];async function toggleRelay(t,a){const e=document.getElementById("relay-"+t),n=document.getElementById("status-"+t),s=e.querySelectorAll("button");s.forEach(t=>{t.disabled=!0,t.classList.add("loading")});try{const e=await fetch(`/api/relay?id=${t}&action=${a}`),s=await e.json();if(s.success){const t="on"===s.state;n.textContent=t?"ON":"OFF",n.className=t?"status on":"status off"}}catch(t){console.error("Error:",t),alert("Failed to control relay. Please try again.")}finally{s.forEach(t=>{t.disabled=!1,t.classList.remove("loading")})}}async function updateStatus(){try{const t=await fetch("/api/status");(await t.json()).relays.forEach(t=>{const a=document.getElementById("status-"+t.id);if(a){const e="on"===t.state;a.textContent=e?"ON":"OFF",a.className=e?"status on":"status off"}})}catch(t){console.error("Status update error:",t)}}function createRelayCards(){const t=document.getElementById("relays");for(let a=0;a<4;a++){const e=document.createElement("div");e.className="card",e.id="relay-"+a,e.innerHTML=`\n            <div class="relay-header">\n                <span class="relay-name">${RELAY_NAMES[a]}</span>\n                <span class="status off" id="status-${a}">OFF</span>\n            </div>\n            <div class="btn-group">\n                <button class="btn-on" onclick="toggleRelay(${a}, 'on')">Turn On</button>\n                <button class="btn-off" onclick="toggleRelay(${a}, 'off')">Turn Off</button>\n            </div>\n        `,t.appendChild(e)}}document.addEventListener("DOMContentLoaded",()=>{createRelayCards(),updateStatus(),setInterval(updateStatus,5e3)});